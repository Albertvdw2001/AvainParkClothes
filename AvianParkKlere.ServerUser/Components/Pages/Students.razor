@page "/students"

@using AvianParkKlere.Contracts.Dtos.Student
@using AvianParkKlere.ServerUser.Components.CrudDialogs.Generic
@using AvianParkKlere.ServerUser.Components.Shared
@using AvianParkKlere.ServerUser.Services
@using MudBlazor

@inject ApiService _apiService
@inject ISnackbar _snackbar
@inject IDialogService _dialogService   

@rendermode InteractiveServer

@* Data Grid *@

<GenericDataGrid @ref="Table"
                Items="StudentList"
                HeaderTitles="@(["Id", "Name", "Surname", "Age", "Grade"])"
                TGet="StudentGetDto"
                TCreate="StudentPostDto"
                TUpdate="StudentPutDto"
                OnCreateNewItem="OpenCreateDialog"
                EnableCrudOptions="true" >
    <RowTemplate>
        <MudTd DataLabel="Id">@context.Id</MudTd>
        <MudTd DataLabel="Name">@context.Name</MudTd>
        <MudTd DataLabel="Description">@context.Surname</MudTd>
        <MudTd DataLabel="Price">@context.Age</MudTd>
        <MudTd DataLabel="PLU">@context.Grade</MudTd>
    </RowTemplate>
</GenericDataGrid>

@* Dialogs *@

@* <CreateUpdateDialog @ref="CreateDialog" 
    TitleText="Create Student" 
    SubmitText="Create" 
    SubmitMethod="@HandleCreateStudent"
                    SubmitButtonEnabled="@Validated"
    OnClose="@GetStudentList" >
    <FormTemplate>
    <MudForm FieldChanged="ValidateForm">
        <MudTextField @bind-Value="CreateDialogStudent.Name" Label="Name" Required="true" Immediate="true" />

        <MudTextField @bind-Value="CreateDialogStudent.Surname" Label="Surname" Required="true" Immediate="true" />

        <MudNumericField @bind-Value="CreateDialogStudent.Age" Label="Age" Required="true" Immediate="true" />

        <MudNumericField @bind-Value="CreateDialogStudent.Grade" Label="Grade" Required="true" Immediate="true" />
    </MudForm>
    </FormTemplate>
</CreateUpdateDialog> *@
    
